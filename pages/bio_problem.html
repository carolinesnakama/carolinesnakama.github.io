<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bioprocess Optimization Problem · MPCC Library</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MPCC Library</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><a class="tocitem" href="flash_problem.html">Flash Tank Problem</a></li><li><a class="tocitem" href="tes_problem.html">Thermal Energy Storage Problem</a></li><li class="is-active"><a class="tocitem" href="bio_problem.html">Bioprocess Optimization Problem</a></li><li><a class="tocitem" href="biopt_problem.html">Bilevel Optimization Problem</a></li><li><a class="tocitem" href="mpec_collection.html">MPEC Collection</a></li><li><a class="tocitem" href="mpcc_methods.html">Methods</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="bio_problem.html">Bioprocess Optimization Problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="bio_problem.html">Bioprocess Optimization Problem</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Process-Optimization-and-Control/MPCCLibrary/blob/master/docs/src/pages/bio_problem.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Bioprocess-Optimization-Problem"><a class="docs-heading-anchor" href="#Bioprocess-Optimization-Problem">Bioprocess Optimization Problem</a><a id="Bioprocess-Optimization-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Bioprocess-Optimization-Problem" title="Permalink"></a></h1><h4 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h4><p>Consider a fed-batch process of <em>E. coli</em> growing on glucose and acetate. We want to optimize the glucose feed to maximize cellular concentration in the end of the batch. However, instead of using <a href="https://en.wikipedia.org/wiki/Monod_equation">Monod equation</a> to represent cellular growth, we will use a more detailed model that uses the microrganism&#39;s metabolic network, namely flux balance analysis (FBA), so we can better represent growth on both substrates. Flux balance analysis (FBA) is essentially an optimization problem that calculates the flow of metabolites (internal or external cellular products) through a metabolic network<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, in which the objective function is usually set to maximize cellular growth. FBA was originally proposed for steady state analysis, but it has been adapted to model dynamic processes as well<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>. </p><p>For this case study, we consider a simplified metabolic network with 4 overall reactions (only external metabolites are considered), as shown in [2], to model cellular growth.</p><p><img src="../images/ecoli_network.png" alt="ecoli_network"/></p><p>The feed in this batch process contains only glucose, but acetate can be produced by the cell and is available in the medium initially. The rate of glucose uptake is limited by the <a href="https://en.wikipedia.org/wiki/Michaelis%E2%80%93Menten_kinetics">Michaelis-Menten equation</a> and availability of oxigen in the medium is limited by mass transport from the gas phase. Given a fixed amount of glucose to be added to the bioreactor, we want to find a feed flow profile that maximizes biomass concentration in the end of the process. Mathematically, this problem is formulated as</p><div>\[    \begin{aligned}
        \min_D \quad &amp;x_\text{end} \\
        \text{s.t.} \quad &amp; \sum_i D_iz_\text{glu,f} = \text{Glu}_\text{total} \\
                          &amp;D \ge 0 \\
                          &amp;\min_{z,x,v} \quad \sum_{r \in \mathcal{R}} v_r \\
                          &amp;\text{s.t.} \quad \frac{dz_\text{glu}}{dt} = A^\text{glu}vx + D(z_\text{glu,f} - z_\text{glu}) \\
                          &amp;\quad \quad \quad \frac{dz_\text{Ac}}{dt} = A^\text{Ac}vx - Dz_\text{Ac} \\
                          &amp;\quad \quad \quad \frac{dz_{\text{O}_2}}{dt} = A^{\text{O}_2}vx - Dz_{\text{O}_2} + kLa(0.21 - z_{\text{O}_2}) \\
                          &amp;\quad \quad \quad \frac{dx}{dt} = \sum_{r in \mathcal{R}}v_r x - Dx \\
                          &amp;\quad \quad \quad A^\text{glu}v \le \frac{v_\text{glu,max}z_\text{glu}}{K_m + z_\text{glu}} \\
                          &amp;\quad \quad \quad -A^{\text{O}_2}v \le v_{\text{O}_2,\text{max}} \\
                          &amp;\quad \quad \quad A^\text{Ac}v \le 100 \\
                          &amp;\quad \quad \quad z,x,v \ge 0 
    \end{aligned}\]</div><p>where <span>$D = F/V$</span>(feed flow rate divided by the volume of the bioreactor) is the dilution rate, <span>$z_i$</span> is the concentration of the <span>$i^\text{th}$</span> metabolite in the bioreactor, <span>$z_\text{glu,f}$</span> is the glucose concentration in the feed, Glu<span>$_\text{total}$</span> is the total amount o glucose to be fed to the bioreactor during the process, <span>$v_r$</span> is the rate of reaction <span>$r \in \mathcal{R}$</span>, A is the stoichiometry matrix (superscript <span>$i$</span> means the row corresponding to metabolite <span>$i$</span>), <span>$kLa$</span> is the mass transfer coefficient for oxygen, <span>$x$</span> is biomass concentration in the bioreactor, <span>$v_\text{glu,max}$</span> and <span>$K_m$</span> are parameters for the Michaelis-Menten equation, and <span>$v_{\text{O}_2,\text{max}}$</span> is the maximum rate for oxygen consumption. </p><h4 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h4><p>We considered two scenarios for this implementation, file <a href="https://github.com/Process-Optimization-and-Control/MPCCLibrary/tree/main/scripts/bioprocess/fed_batch.jl">fed_batch.jl</a> implements the dynamic FBA model with constant <span>$D = \text{Glu}_\text{total}/z_\text{glu,f}\text{NFE}$</span>, where NFE is the number os finite elements in the time discretization and file <a href="https://github.com/Process-Optimization-and-Control/MPCCLibrary/tree/main/scripts/bioprocess/fed_batch_opt.jl">fed_batch_opt.jl</a> implements the bilevel optimization just described. The latter is reformulated as an MPCC problem and solved. Orthogonal collocation with 3 collocation points and 77 finite elements was implemented. In both cases, the required values used are</p><p><span>$A^\text{glu} = [\begin{array}{cccc}0 &amp; -9.46 &amp; -9.84 &amp; -19.23\end{array}]$</span>, <br/><span>$A^{\text{O}_2} = [\begin{array}{cccc} -35 &amp; -12.92 &amp; -12.73 &amp; 0\end{array}]$</span>, <br/><span>$A^\text{Ac} = [\begin{array}{cccc} -39.43 &amp; 0 &amp; 1.24 &amp; 12.12\end{array}]$</span>, <br/><span>$x_0 = 0.001$</span> g/L, <br/><span>$z_{\text{glu},0} = 1$</span> mmol/L, <br/><span>$z_{\text{O}_2,0} = 0.21$</span> mmol/L, <br/><span>$z_{\text{Ac},0} = 0.4$</span> mmol/L, <br/><span>$v_{i,0} = 0$</span>, <br/><span>$t_0 = 0$</span>, <br/><span>$t_\text{end} = 11$</span> h, <br/><span>$kLa = 7.5$</span> h<span>$^{-1}$</span>, <br/><span>$v_{\text{O}_2,\text{max}} = 15$</span> mmol/gDW.h, <br/><span>$v_\text{glu,max} = 10$</span> mmol/gDW.h, <br/><span>$K_m = 0.015$</span> mmol/L, <br/><span>$z_\text{glu,f} = 5$</span> mmol/L.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://www.nature.com/articles/nbt.1614">Orth, J. D., Thiele, I., and Palsson, B. Ø. What is flux balance analysis? <em>Nature biotechnology</em>, 28(3), 245-248, 2010.</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><a href="https://www.sciencedirect.com/science/article/pii/S0006349502739039">Mahadevan, R., Edwards, J. S., and Doyle III, F. J. Dynamic flux balance analysis of diauxic growth in <em>Escherichia coli</em>. <em>Biophysical journal</em>, 83(3), 1331-1340, 2002.</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="tes_problem.html">« Thermal Energy Storage Problem</a><a class="docs-footer-nextpage" href="biopt_problem.html">Bilevel Optimization Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 29 January 2021 17:43">Friday 29 January 2021</span>. Using Julia version 1.5.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
